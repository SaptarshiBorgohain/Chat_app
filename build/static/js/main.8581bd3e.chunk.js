(this["webpackJsonpimessage-clone"]=this["webpackJsonpimessage-clone"]||[]).push([[0],{60:function(e,t,c){},61:function(e,t,c){},62:function(e,t,c){},63:function(e,t,c){},67:function(e,t,c){},72:function(e,t,c){},73:function(e,t,c){},74:function(e,t,c){},75:function(e,t,c){"use strict";c.r(t);var a=c(5),n=c(2),s=c.n(n),i=c(18),o=c.n(i),r=(c(60),c(61),c(22)),l=Object(r.b)({name:"user",initialState:{user:null},reducers:{login:function(e,t){e.user=t.payload},logout:function(e){e.user=null}}}),d=l.actions,u=d.login,j=d.logout,h=function(e){return e.user.user},m=l.reducer,b=(c(62),c(21)),O=c(89),p=c(87),f=(c(63),c(46)),v=c.n(f),x=c(47),g=c.n(x),N=c(11),_=(c(67),Object(r.b)({name:"chat",initialState:{chatId:null,chatName:null},reducers:{setChat:function(e,t){e.chatId=t.payload.chatId,e.chatName=t.payload.chatName}}})),S=_.actions.setChat,I=function(e){return e.chat.chatName},y=function(e){return e.chat.chatId},w=_.reducer,C=c(24),k=C.a.initializeApp({apiKey:"AIzaSyAXy15IkZRUcZfIc0NssMDGu9uctiC-Wj4",authDomain:"imessage-clone-home.firebaseapp.com",databaseURL:"https://imessage-clone-home.firebaseio.com",projectId:"imessage-clone-home",storageBucket:"imessage-clone-home.appspot.com",messagingSenderId:"709083016172",appId:"1:709083016172:web:3e9c62e96128dd5aeaeec9",measurementId:"G-B31TS0C964"}).firestore(),D=C.a.auth(),B=new C.a.auth.GoogleAuthProvider,A=k,E=c(50);var M=function(e){var t,c,s,i,o=e.id,r=e.chatName,l=Object(N.b)(),d=Object(n.useState)([]),u=Object(b.a)(d,2),j=u[0],h=u[1];return Object(n.useEffect)((function(){A.collection("chats").doc(o).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return h(e.docs.map((function(e){return e.data()})))}))}),[o]),Object(a.jsxs)("div",{onClick:function(){l(S({chatId:o,chatName:r}))},className:"SidebarChat",children:[Object(a.jsx)(O.a,{src:null===(t=j[0])||void 0===t?void 0:t.photo}),Object(a.jsxs)("div",{className:"SidebarChat__info",children:[Object(a.jsx)("h3",{children:r}),Object(a.jsx)("p",{children:null===(c=j[0])||void 0===c?void 0:c.message}),Object(a.jsx)("small",{children:E.a(new Date(null===(s=j[0])||void 0===s||null===(i=s.timestamp)||void 0===i?void 0:i.toDate()).toLocaleString())})]})]})};var L=function(){var e=Object(N.c)(h),t=Object(n.useState)([]),c=Object(b.a)(t,2),s=c[0],i=c[1];return Object(n.useEffect)((function(){A.collection("chats").onSnapshot((function(e){i(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[]),Object(a.jsxs)("div",{className:"sidebar",children:[Object(a.jsxs)("div",{className:"sidebar__header",children:[Object(a.jsx)(O.a,{onClick:function(){return D.signOut()},src:e.photo,className:"sidebar__avatar"}),Object(a.jsxs)("div",{className:"sidebar__input",children:[Object(a.jsx)(v.a,{}),Object(a.jsx)("input",{placeholder:"Search"})]}),Object(a.jsx)(p.a,{variant:"outlined",className:"sidebar__inputButton",children:Object(a.jsx)(g.a,{onClick:function(){var e=prompt("Please enter a chat name");e&&A.collection("chats").add({chatName:e})}})})]}),Object(a.jsx)("div",{className:"sidebar__chats",children:s.map((function(e){var t=e.id,c=e.data.chatName;return Object(a.jsx)(M,{id:t,chatName:c},t)}))})]})},R=(c(72),c(49)),W=c.n(R),G=(c(73),Object(n.forwardRef)((function(e,t){e.id;var c=e.contents,n=c.timestamp,s=(c.displayName,c.email),i=c.message,o=c.photo,r=(c.uid,Object(N.c)(h));return Object(a.jsxs)("div",{ref:t,className:"message ".concat(r.email===s&&"message__sender"),children:[Object(a.jsx)(O.a,{className:"message__photo",src:o}),Object(a.jsx)("p",{children:i}),Object(a.jsx)("small",{children:new Date(null===n||void 0===n?void 0:n.toDate()).toLocaleString()})]})}))),P=c(48);var T=function(){var e=Object(N.c)(h),t=Object(n.useState)(""),c=Object(b.a)(t,2),s=c[0],i=c[1],o=Object(N.c)(I),r=Object(N.c)(y),l=Object(n.useState)([]),d=Object(b.a)(l,2),u=d[0],j=d[1];return Object(n.useEffect)((function(){r&&A.collection("chats").doc(r).collection("messages").orderBy("timestamp","desc").onSnapshot((function(e){return j(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[r]),Object(a.jsxs)("div",{className:"chat",children:[Object(a.jsxs)("div",{className:"chat__header",children:[Object(a.jsxs)("h4",{children:["To: ",Object(a.jsx)("span",{className:"chat__name",children:o})]}),Object(a.jsx)("strong",{children:"Details"})]}),Object(a.jsx)("div",{className:"chat__messages",children:Object(a.jsx)(P.a,{children:u.map((function(e){var t=e.id,c=e.data;return Object(a.jsx)(G,{contents:c},t)}))})}),Object(a.jsxs)("div",{className:"chat__input",children:[Object(a.jsxs)("form",{children:[Object(a.jsx)("input",{value:s,onChange:function(e){return i(e.target.value)},placeholder:"IMessage",type:"text"}),Object(a.jsx)("button",{onClick:function(t){t.preventDefault(),A.collection("chats").doc(r).collection("messages").add({timestamp:C.a.firestore.FieldValue.serverTimestamp(),message:s,uid:e.uid,photo:e.photo,email:e.email,displayName:e.displayName}),i("")},children:" Send Message "})]}),Object(a.jsx)(p.a,{children:Object(a.jsx)(W.a,{className:"chat__mic"})})]})]})};var U=function(){return Object(a.jsxs)("div",{className:"IMessage",children:[Object(a.jsx)(L,{}),Object(a.jsx)(T,{})]})},z=c(88);c(74);var J=function(){return Object(a.jsxs)("div",{className:"login",children:[Object(a.jsxs)("div",{className:"login__logo",children:[Object(a.jsx)("img",{src:"https://cdn.jim-nielsen.com/ios/512/spike-email-messenger-chat-2019-05-01.png",alt:""}),Object(a.jsx)("h1",{children:"Swift"})]}),Object(a.jsx)(z.a,{onClick:function(){D.signInWithPopup(B).catch((function(e){return alert(e.message)}))},children:"Sign In"})]})};var Z=function(){var e=Object(N.c)(h),t=Object(N.b)();return Object(n.useEffect)((function(){D.onAuthStateChanged((function(e){t(e?u({uid:e.uid,photo:e.photoURL,email:e.email,displayName:e.displayName}):j())}))}),[]),Object(a.jsx)("div",{className:"app",children:e?Object(a.jsx)(U,{}):Object(a.jsx)(J,{})})},F=Object(r.a)({reducer:{user:m,chat:w}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(N.a,{store:F,children:Object(a.jsx)(Z,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[75,1,2]]]);
//# sourceMappingURL=main.8581bd3e.chunk.js.map